import time
import spidev

# Create SPI object

BK0_WHO_AM_I = (0)
BK0_USER_CTRL = (3)
BK0_LP_CONFIG = (5)

BK0_PWR_MGMT_1 = (6)
BK0_PWR_MGMT_2 = (7)
BK0_INT_PIN_CFG =  15
BK0_INT_ENABLE =  16
BK0_INT_ENABLE_1 =  17
BK0_INT_ENABLE_2 =  18
BK0_INT_ENABLE_3 =  19
BK0_I2C_MST_STATUS =  23
BK0_INT_STATUS =  25
BK0_INT_STATUS_1 =  26
BK0_INT_STATUS_2 =  27
BK0_INT_STATUS_3 =  28
BK0_DELAY_TIMEH =  40
BK0_DELAY_TIMEL =  41
BK0_ACCEL_XOUT_H =  45
BK0_ACCEL_XOUT_L =  46
BK0_ACCEL_YOUT_H =  47
BK0_ACCEL_YOUT_L =  48
BK0_ACCEL_ZOUT_H =  49
BK0_ACCEL_ZOUT_L =  50
BK0_GYRO_XOUT_H =  51
BK0_GYRO_XOUT_L =  52
BK0_GYRO_YOUT_H =  53
BK0_GYRO_YOUT_L =  54
BK0_GYRO_ZOUT_H =  55
BK0_GYRO_ZOUT_L =  56
BK0_TEMP_OUT_H =  57
BK0_TEMP_OUT_L =  58
BK0_EXT_SLV_SENS_DATA_00 =  59
BK0_EXT_SLV_SENS_DATA_23 =  82
BK0_FIFO_EN_1 =  102
BK0_FIFO_EN_2 =  103
BK0_FIFO_RST =  104
BK0_FIFO_MODE =  105
BK0_FIFO_COUNTH =  112
BK0_FIFO_COUNTL =  113
BK0_FIFO_R_W =  114
BK0_DATA_RDY_STATUS =  116
BK0_FIFO_CFG =  118

# IMU registers Bank2
BK2_GYRO_SMPLRT_DIV = 0
BK2_GYRO_CONFIG_1 =  1
BK2_GYRO_CONFIG_2 =  2
BK2_XG_OFFS_USRH =  3
BK2_XG_OFFS_USRL =  4
BK2_YG_OFFS_USRH =  5
BK2_YG_OFFS_USRL =  6
BK2_ZG_OFFS_USRH =  7
BK2_ZG_OFFS_USRL =  8
BK2_ODR_ALIGN_EN =  9
BK2_ACCEL_SMPLRT_DIV_1 =  16
BK2_ACCEL_SMPLRT_DIV_2 =  17
BK2_ACCEL_INTEL_CTRL =  18
BK2_ACCEL_WOM_THR =  19
BK2_ACCEL_CONFIG =  20
BK2_ACCEL_CONFIG_2 =  21
BK2_FSYNC_CONFIG =  82
BK2_TEMP_CONFIG =  83
BK2_MOD_CTRL_USR =  84

# IMU registers Bank2
REG_BANK_SEL = (127)


spi = spidev.SpiDev()
spi.open(0, 0)  # Specify the SPI bus and device

# Set SPI mode and clock frequency
spi.mode = 3  # Mode 0 =? CPOL = 0 and clock phase CPHA = 0
spi.max_speed_hz = 7000000  # Set the clock frequency to 1 MHz

spi.writebytes([BK0_WHO_AM_I, 0]) # REG_BANK_SEL

spi.writebytes([BK0_PWR_MGMT_1, 0x80]) # BK0_PWR_MGMT_1
time.sleep(0.1)

spi.writebytes([BK0_USER_CTRL, 0x10]) # BK0_USER_CTRL

spi.writebytes([BK0_LP_CONFIG, 0x00]) # BK0_LP_CONFIG

spi.writebytes([BK0_PWR_MGMT_2, 0x00]) # BK0_PWR_MGMT_2

spi.xfer2([BK0_WHO_AM_I | 0x80, 0x00])
